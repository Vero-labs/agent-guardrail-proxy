id: default
name: Default Security Policy
description: Signal-only policy configuration for Cedar-governed LLM interactions
version: "2.0.0"

# IMPORTANT: This file configures SIGNAL GENERATORS only.
# All enforcement decisions are made by Cedar policies in policies.cedar.
# Do NOT add action: fields here - they are ignored.

guardrails:
  input:
    prompt_injection:
      enabled: true
      sensitivity: medium
      emit: prompt_injection  # Emits boolean signal to context.signals.prompt_injection
      custom_patterns: []

    pii_detection:
      enabled: true
      types:
        - email
        - phone
        - ssn
        - credit_card
      emit: pii  # Emits []string signal to context.signals.pii

    topic_boundary:
      enabled: true
      allowed_topics: []
      blocked_topics:
        - violence
        - illegal_activity
        - harmful_content
        - explicit_content
      emit: topic  # Emits string signal to context.signals.topic

    toxicity:
      enabled: true
      threshold: 0.7
      emit: toxicity  # Emits float signal to context.signals.toxicity

  output:
    hallucination_detection:
      enabled: true
      grounding_sources: []
      emit: hallucination  # Emits boolean signal

    format_validation:
      enabled: false
      schema: null
      strict_mode: false
      emit: format_violation

    content_moderation:
      enabled: true
      categories:
        - hate
        - violence
        - self_harm
        - sexual
      emit: moderation  # Emits []string signal

    llm_judge:
      enabled: false
      model: ""
      categories:
        - hate
        - violence
        - self_harm
        - sexual
        - drugs
        - weapons
      threshold: 0.6
      max_tokens: 256
      temperature: 0.0
      emit: llm_judge  # Emits structured signal

  deterministic_controls:
    rate_limit:
      enabled: true
      requests_per_minute: 5
      requests_per_hour: 100
      key_by: global
    payload_size:
      enabled: true
      max_request_size: 10485760
      max_messages: 50
    max_tokens:
      enabled: true
      max_input_tokens: 4096

logging:
  level: info
  include_body: false
  retention_days: 30
